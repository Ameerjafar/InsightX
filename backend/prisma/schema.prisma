generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum CryptoCurrency {
  BTC
  SOL
  ETH
}

enum CryptoType {
  SELL
  BUY
}

model User {
  id               Int               @id @default(autoincrement())
  email            String            @unique
  password         String
  createdAt        DateTime          @default(now())
  balances         Balance[]
  individualAssets IndividualAsset[]
}

model Balance {
  id           Int               @id @default(autoincrement())
  USD          Int               @default(5000)
  userId       Int
  freeMargin   Int
  lockedMargin Int
  user         User              @relation(fields: [userId], references: [id])
  assets       IndividualAsset[]
}

model IndividualAsset {
  id              Int            @id @default(autoincrement())
  cryptoValue     Float
  quantity        Float
  crypto          CryptoCurrency
  type            CryptoType
  stopLoss        Float?
  takeProfit      Float?
  userId          Int
  leveragePercent Int?
  leverageStatus  Boolean
  user            User           @relation(fields: [userId], references: [id])
  BalanceId       Int
  balance         Balance        @relation(fields: [BalanceId], references: [id])
}

model OHLC {
  id        Int      @id @default(autoincrement())
  crypto    String
  interval  String
  open      Float
  high      Float
  low       Float
  close     Float
  volume    Float
  timestamp DateTime

  @@unique([crypto, interval, timestamp], name: "crypto_interval_timestamp")
}
